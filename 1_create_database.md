CREATE DATABASE `train_mysql`;
CREATE table user (
  id INT UNSIGNED NOT NULL AUTO_INCREMENT,
  full_name VARCHAR(255),
  email VARCHAR(255),
  rank TINYINT(4),
  is_active TINYINT(1),
  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY(id)
);

CREATE TABLE category (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `title` VARCHAR(255),
  `description` VARCHAR(255),
  PRIMARY KEY(`id`)
);

CREATE TABLE news (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `category_id` INT UNSIGNED NOT NULL,
  `title` VARCHAR(255),
  `view` INT UNSIGNED,
  `is_active` TINYINT(1),
  `content` TEXT,
  `created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY(`id`),
  FOREIGN KEY (`category_id`) REFERENCES category(id)
);

CREATE TABLE comment (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `target_table` VARCHAR(20),
  `target_id` INT UNSIGNED,
  `user_id` INT UNSIGNED NOT NULL,
  `comment` TEXT,
  `created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY(`id`),
  FOREIGN KEY (`user_id`) REFERENCES user(id)
);

CREATE TABLE IF NOT EXISTS `follow` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `from_user_id` INT UNSIGNED NOT NULL,
  `to_user_id` INT UNSIGNED,
  `created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY(`id`),
  FOREIGN KEY (`from_user_id`) REFERENCES user(id)
);

CREATE TABLE IF NOT EXISTS `blog` (
  `id` INT UNSIGNED NOT NULL AUTO_INCREMENT,
  `category_id` INT UNSIGNED NOT NULL,
  `user_id` INT UNSIGNED NOT NULL,
  `title` VARCHAR(255),
  `view` INT UNSIGNED,
  `is_active` TINYINT(1),
  `content` TEXT,
  `created_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY(`id`),
  FOREIGN KEY (`category_id`) REFERENCES category(`id`),
  FOREIGN KEY (`user_id`) REFERENCES user(`id`)
);